# Ajax

[[Web] Ajax ì™„ë²½ ì •ë¦¬, ë‹¤ì–‘í•œ ì˜ˆì œ í¬í•¨](https://jbground.tistory.com/4)

### Ajaxë€?

`Ajax (Asynchronous JavaScript and XML)`

javascriptì™€ XML(ë˜ëŠ” JSON)ì„ ì´ìš©í•œ *ë¹„ë™ê¸°ì  ì •ë³´ êµí™˜* ê¸°ë²•

ë¸Œë¼ìš°ì €ì˜ XMLHttpRequestë¥¼ ì´ìš©í•´ í˜ì´ì§€ ì¼ë¶€ë§Œì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ë°ì´í„°ë¥¼ ë³„ë„ë¡œ ìš”ì²­í•˜ëŠ” ê¸°ë²•

HTTP í”„ë¡œí† ì½œì„ ì´ìš©í•œ **ë¹„ë™ê¸° í†µì‹ **

ì •ì  HTML / CSSíŒŒì¼, ë°ì´í„° ìš”ì²­ ë°©ì‹ì„ ì ì€ javascript > HTML,CSSë¥¼ ì´ìš©í•´ ê³¨ê²© í˜•ì„±

ajax ì‹¤í–‰ ë¶€ê°€ ë‹´ê¸´ javascript ì˜ì—­ì„ ì‹¤í–‰, ë°ì´í„°ë¥¼ ë³„ë„ ìš”ì²­í•´ í˜ì´ì§€ ë¡œë”©

# ì‹¤ìŠµ ì¤€ë¹„

í”„ë¡œì íŠ¸ ìƒì„±

```jsx
npx create-react-app react-ajax
```

- ì•„ë˜ì™€ ê°™ì´ ì½”ë“œ ì‘ì„±
    
    ```jsx
    import React from "react";
    import ReactDOM from "react-dom/client";
    import "./index.css";
    import App from "./App";
    import reportWebVitals from "./reportWebVitals";
    
    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
    
    reportWebVitals();
    
    ```
    
    ```jsx
    function App() {
      return (
        <div className="App">
          <h1>WEB</h1>
          <nav>
            <ul>
              <li>
                <a href="1">HTML</a>
              </li>
              <li>
                <a href="2">CSS</a>
              </li>
              <li>
                <a href="3">JS</a>
              </li>
            </ul>
          </nav>
          <article>
            <h2>Welcome</h2>
            Hello, React &amp; Ajax
          </article>
        </div>
      );
    }
    
    export default App;
    
    ```
    
    ```json
    [
      { "id": 1, "title": "HTML" },
      { "id": 2, "title": "CSS" },
      { "id": 3, "title": "JS" }
    ]
    ```
    
    ```json
    { "id": 1, "title": "HTML", "desc": "HTML is ..." }
    
    ```
    

---

<aside>
ğŸ’¡ **Ajaxë¡œ ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”**

ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘

>> ê¸€ ëª©ë¡ì„ `../public/list.json`ì—ì„œ ì½ì–´ì˜¤ê³ 

>> JSë¥¼ ì´ìš©í•´ <li>íƒœê·¸ ìƒì„±

**Ajaxë¡œ ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ë³€ê²½**

li í•­ëª©ì˜ <a> íƒœê·¸ í´ë¦­í–ˆì„ ë•Œ

>> ë§í¬ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ JSON íŒŒì¼(`public/1.json`)ì—ì„œ ì½ì–´ì„œ <article> ë‚´ìš© ì±„ìš°ê¸°

</aside>

# Ajaxë¡œ ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”

App.jsì—ì„œ nav ì˜ì—­ì„ Nav ì»´í¬ë„ŒíŠ¸ë¡œ ë¶€í’ˆí™”

Nav ì»´í¬ë„ŒíŠ¸ì˜ ëª©ë¡ ë‚´ìš©ì„ Ajaxë¥¼ í†µí•´ ìƒì„±í•˜ë„ë¡ í•´ì•¼ í•˜ëŠ”ë°, ì´ë¥¼ ìœ„í•´ì„œ `componentDidMount` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•œë‹¤.


`componentDidMount` ë©”ì†Œë“œ ë‚´ë¶€ì—ì„œ fetch APIë¥¼ í˜¸ì¶œí•˜ë„ë¡ ì‘ì„±

```jsx
class Nav extends Component {
  componentDidMount() {
    fetch("list.json")
      .then(function (result) {
        return result.json();
      })
      .then(
        function (json) {
          console.log(json);
        }.bind(this)
      );
  }
  render() {
    return (
      ...(ìƒëµ)...
    );
  }
}
```

Nav ì»´í¬ë„ŒíŠ¸ì— state ì¶”ê°€í•œ ë’¤, js ê°ì²´ë¥¼ stateì— ì €ì¥í•˜ì—¬ <ul> íƒœê·¸ ì•ˆì—ì„œ ì¶œë ¥

```jsx
import React, { Component } from "react";

class Nav extends Component {
  **state = {
    list: [],
  };**
  componentDidMount() {
    fetch("list.json")
      .then(function (result) {
        return result.json();
      })
      .then(
        function (json) {
          console.log(json);
          **this.setState({ list: json });**
        }.bind(this)
      );
  }
  render() {
    **var listTag = [];
    for (var i = 0; i < this.state.list.length; i++) {
      var li = this.state.list[i];
      listTag.push(
        <li key={li.id}>
          <a href={li.id}>{li.title}</a>
        </li>
      );**
    }
    return (
      <nav>
        **<ul>{listTag}</ul>**
      </nav>
    );
  }
}
...(ìƒëµ)...
```

Ajaxë¡œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ stateë¡œ ë„˜ê²¨ì„œ render ë©”ì„œë“œê°€ stateì˜ ë³€í™”ì— ì˜í–¥ì„ ë°›ì•„ ì²˜ë¦¬í•˜ë„ë¡ êµ¬í˜„

# Ajaxë¡œ ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ë³€ê²½

list í•­ëª©ì„ í´ë¦­í–ˆì„ ë•Œ, í•´ë‹¹í•˜ëŠ” ì •ë³´ë¥¼ ì½ì–´ì„œ <article> ë¶€ë¶„ì— ì¶œë ¥í•˜ê¸°

<article> ì˜ì—­ì„ ëŒ€ì²´í•˜ëŠ” Article ì»´í¬ë„ŒíŠ¸ ìƒì„±

```jsx
class Article extends Component {
  render() {
    return (
      <article>
        <h2>{this.props.title}</h2>
        {this.props.desc}
      </article>
    );
  }
}

class App extends Component {
  state = {
    article: { title: "welcome", desc: "hello, React & Ajax" },
  };
  render() {
    return (
      <div className="App">
        <h1>WEB</h1>
        <Nav></Nav>
        <Article
          title={this.state.article.title}
          desc={this.state.article.desc}
        ></Article>
      </div>
    );
  }
}
```

Nav ì»´í¬ë„ŒíŠ¸ í•­ëª©ì„ í´ë¦­í–ˆì„ ë•Œ <article>ì˜ ë‚´ìš©ì´ ë³€ê²½ë˜ë„ë¡ êµ¬í˜„

```jsx
import React, { Component } from "react";

class Nav extends Component {
  state = {
    list: [],
  };
  componentDidMount() {
    fetch("list.json")
      .then(function (result) {
        return result.json();
      })
      .then(
        function (json) {
          console.log(json);
          this.setState({ list: json });
        }.bind(this)
      );
  }
  render() {
    var listTag = [];
    for (var i = 0; i < this.state.list.length; i++) {
      var li = this.state.list[i];
      listTag.push(
        **<li key={li.id}>
          <a
            href={li.id}
            data-id={li.id}
            onClick={function (e) {
              e.preventDefault();
              console.log("trigger");
              this.props.onClick(e.target.dataset.id);
            }.bind(this)}
          >**
            {li.title}
          </a>
        </li>
      );
    }
    return (
      <nav>
        <ul>{listTag}</ul>
      </nav>
    );
  }
}

...(ìƒëµ)...

class App extends Component {
  state = {
    article: { title: "welcome", desc: "hello, React & Ajax" },
  };
  render() {
    return (
      <div className="App">
        <h1>WEB</h1>
        <Nav
          **onClick={function (id) {
            fetch(id + ".json")
              .then(function (result) {
                return result.json();
              })
              .then(
                function (json) {
                  this.setState({
                    article: {
                      title: json.title,
                      desc: json.desc,
                    },
                  });
                }.bind(this)
              );
          }.bind(this)}**
        ></Nav>
        <Article
          title={this.state.article.title}
          desc={this.state.article.desc}
        ></Article>
      </div>
    );
  }
}

export default App;

```

# í”„ë ˆì  í…Œì´ì…˜ ì»¨í…Œì´ë„ˆì—ì„œ ë°ì´í„° ì¢…ì†ì„± ì œê±°í•˜ê¸°

### `decoupling`

ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–¤ íŠ¹ì •í•œ ë°ì´í„°ì— ì¢…ì†ë˜ì§€ ì•Šê²Œ ëœ¯ì–´ë‚´ëŠ” ê²ƒ**(UIì™€ Logicì˜ ë¶„ë¦¬)**

ì»´í¬ë„ŒíŠ¸ë¥¼ **`presentational ì»´í¬ë„ŒíŠ¸`**ì™€ **`contianer ì»´í¬ë„ŒíŠ¸`**ë¡œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.

```jsx
import React, { Component } from "react";

class Nav extends Component {
  render() {
    var listTag = [];
    for (var i = 0; i < **this.props.list.length**; i++) {
      var li = **this.props.list**[i];
      listTag.push(
        <li key={li.id}>
          <a
            href={li.id}
            data-id={li.id}
            onClick={function (e) {
              e.preventDefault();
              console.log("trigger");
              this.props.onClick(e.target.dataset.id);
            }.bind(this)}
          >
            {li.title}
          </a>
        </li>
      );
    }
    return (
      <nav>
        <ul>{listTag}</ul>
      </nav>
    );
  }
}

...

class App extends Component {
  state = {
    article: { title: "welcome", desc: "hello, React & Ajax" },
    **list: [],**
  };
  **componentDidMount() {
    fetch("list.json")
      .then(function (result) {
        return result.json();
      })
      .then(
        function (json) {
          console.log(json);
          this.setState({ list: json });
        }.bind(this)
      );
  }**
  render() {
    return (
      <div className="App">
        <h1>WEB</h1>
        <Nav
          **list={this.state.list}**
          onClick={function (id) {
            fetch(id + ".json")
              .then(function (result) {
                return result.json();
              })
              .then(
                function (json) {
                  this.setState({
                    article: {
                      title: json.title,
                      desc: json.desc,
                    },
                  });
                }.bind(this)
              );
          }.bind(this)}
        ></Nav>
        <Article
          title={this.state.article.title}
          desc={this.state.article.desc}
        ></Article>
      </div>
    );
  }
}

export default App;

```

# ë¡œë”© ì¤‘ ê¸°ëŠ¥ êµ¬í˜„

### ëŠë¦° í†µì‹ ë§ ì‹œë®¬ë ˆì´ì…˜

í¬ë¡¬ ê°œë°œì ë„êµ¬ > ë„¤íŠ¸ì›Œí¬ ì„¤ì • > ë„¤íŠ¸ì›Œí¬ ì¡°ê±´ > ë„¤íŠ¸ì›Œí¬ ì œí•œ > ëŠë¦° 3G

```jsx
...
class NowLoading extends Component {
  render() {
    return <div>Now Loading...</div>;
  }
}

class App extends Component {
  state = {
    article: {
      item: { title: "welcome", desc: "hello, React & Ajax" },
      isLoading: false,
    },
    list: { items: [], isLoading: false },
  };

  componentDidMount() {
    var newList = Object.assign({}, this.state.list, { isLoading: true });
    this.setState({ list: newList });
    fetch("list.json")
      .then(function (result) {
        return result.json();
      })
      .then(
        function (json) {
          console.log(json);
          this.setState({ list: { items: json, isLoading: false } });
        }.bind(this)
      );
  }

  render() {
    var NavTag = null;
    if (this.state.list.isLoading) {
      NavTag = <NowLoading />;
    } else {
      NavTag = (
        <Nav
          list={this.state.list.items}
          onClick={function (id) {
            var newArticle = Object.assign({}, this.state.article, {
              isLoading: true,
            });
            this.setState({ article: newArticle });
            fetch(id + ".json")
              .then(function (result) {
                return result.json();
              })
              .then(
                function (json) {
                  this.setState({
                    article: {
                      item: {
                        title: json.title,
                        desc: json.desc,
                      },
                      isLoading: false,
                    },
                  });
                }.bind(this)
              );
          }.bind(this)}
        />
      );
    }

    var ArticleTag = null;
    if (this.state.article.isLoading) {
      ArticleTag = <NowLoading />;
    } else {
      ArticleTag = (
        <Article
          title={this.state.article.item.title}
          desc={this.state.article.item.desc}
        />
      );
    }

    return (
      <div className="App">
        <h1>WEB</h1>
        {NavTag}
        {ArticleTag}
      </div>
    );
  }
}

export default App;

```
